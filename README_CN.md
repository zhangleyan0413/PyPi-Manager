# PyPi Manager

全称：Python Pip Manager

版本：1.3.0

一个功能强大的Python版本管理工具，支持选择安装不同版本的Python，管理依赖库，修复pip问题，以及配置镜像源。

## 功能特性

### 📦 pip包管理
- 显示已安装的包
- 搜索包并显示版本信息
- 安装指定版本的包
- 升级包到最新版本
- 卸载不需要的包
- 从wheel文件安装包

### 🔧 pip修复
- 检查pip状态
- 使用ensurepip修复pip
- 使用get-pip.py脚本安装pip
- 自动检测pip错误并建议修复

### 🚀 镜像源配置
- 内置5个推荐镜像源（清华、中科大、阿里云、豆瓣、官方）
- 添加自定义镜像源
- 删除自定义镜像源
- 设置默认镜像源

### ⚡ 批量包管理
- 批量更新所有可更新的包
- 批量卸载多个包
- 导出已安装的包列表到requirements.txt
- 从requirements.txt文件安装包

### 🐍 Python版本管理
- 获取可用的Python版本列表
- 安装指定版本的Python
- 检查已安装的Python版本及其路径

### 🌐 Python环境管理
- 列出所有虚拟环境
- 创建新的虚拟环境
- 激活虚拟环境
- 删除虚拟环境

### 🛠️ 工具
- 使用autopep8进行代码格式化
- 使用pylint进行代码检查

### 🔍 文件完整性检查
- 检查程序文件的完整性
- 从GitHub自动修复缺失或损坏的文件

### 📖 文档
- 详细的功能介绍
- 使用指南
- 快捷键
- 常见问题

### 🖥️ GUI版本
- 基于wxPython的图形界面
- 现代、用户友好的设计
- 实时进度条
- 详细的状态更新
- 常用操作的快速访问按钮

### 💡 智能功能
- 为所有耗时操作添加了进度条和加载动画
- 支持国内镜像源加速
- 详细的错误提示和解决方案
- 多线程执行耗时操作，避免界面卡顿

## 安装步骤

1. **下载程序**
   - 克隆或下载本仓库到本地
   - 确保下载到的文件结构完整

2. **运行初始化脚本**
   - 双击运行 `setup.bat` 文件
   - 脚本会自动检查Python安装情况
   - 如果未安装Python，会自动下载并安装
   - 如果已安装Python，会检查并安装所需依赖

3. **开始使用**
   - 初始化完成后，程序会自动启动
   - 按照菜单提示进行操作

## 使用方法

### 主菜单

```
PyPi Manager
1. 管理pip包
2. 检查并修复pip
3. 配置镜像源
4. 批量包管理
5. Python版本管理
6. Python环境管理
7. 工具
8. 检查更新
9. 检查文件完整性
10. 文档
11. 关于作者
12. 退出
```

### pip包管理菜单

```
pip包管理菜单
1. 显示已安装的包
2. 搜索包
3. 安装包
4. 升级包
5. 卸载包
6. 从wheel文件安装包
7. 返回主菜单
```

### 配置镜像源菜单

```
镜像源管理菜单
1. 显示当前镜像源
2. 选择内置镜像源
3. 添加自定义镜像源
4. 删除自定义镜像源
5. 设置默认镜像源
6. 返回主菜单
```

### 批量包管理菜单

```
批量包管理菜单
1. 检查可更新的包
2. 批量更新所有包
3. 批量卸载包
4. 导出已安装的包列表
5. 从文件安装包
6. 返回主菜单
```

### Python版本管理菜单

```
Python版本管理菜单
1. 获取可用Python版本
2. 安装指定版本
3. 检查已安装的Python版本
4. 返回主菜单
```

## 常见问题

### Q: 安装Python时失败怎么办？
A: 检查网络连接，确保可以访问Python官网。如果持续失败，可以尝试手动下载Python安装包并安装。

### Q: pip安装依赖库时出错怎么办？
A: 程序会自动检测pip错误并建议修复方法。您可以选择使用ensurepip修复pip，或使用get-pip.py脚本重新安装。

### Q: 如何加速依赖库下载？
A: 在设置中选择国内镜像源（如清华源、阿里云源），可以显著提高下载速度。

### Q: 如何安装特定版本的依赖库？
A: 在安装依赖库时，输入版本号即可，例如：`requests==2.31.0`。

### Q: 如何查看已安装的Python版本？
A: 在主菜单中选择"3. 检查已安装的Python版本"，程序会显示所有已安装的Python版本及其路径。

## 技术说明

### 核心模块
- `main.py` - 主程序入口，包含命令行界面和核心逻辑
- `main_gui.py` - 程序的GUI版本，使用wxPython
- `diagnostic.py` - 文件完整性检查工具
- `version_fetcher.py` - 获取Python版本信息
- `installer.py` - 处理Python安装过程
- `setup.bat` - 环境初始化脚本

### 依赖项
- Python 3.6+
- requests（用于获取Python版本信息）
- wxPython（用于GUI版本）
- autopep8（用于代码格式化）
- pylint（用于代码检查）

### 系统要求
- Windows操作系统
- 网络连接（用于下载Python安装包和依赖库）
- 管理员权限（用于安装Python）

## 示例用法

### 安装Python 3.10.11

1. 运行 `setup.bat` 启动程序
2. 选择 "1. 获取可用Python版本"
3. 选择 "2. 安装指定版本"
4. 输入版本编号（对应Python 3.10.11）
5. 确认安装
6. 等待安装完成

### 安装依赖库

1. 运行 `setup.bat` 启动程序
2. 选择 "4. 管理Python依赖库"
3. 选择 "3. 安装依赖库"
4. 输入依赖库名称（如 `requests`）
5. 选择是否指定版本（按回车安装最新版本）
6. 等待安装完成

### 修复pip

1. 运行 `setup.bat` 启动程序
2. 选择 "4. 管理Python依赖库"
3. 选择 "7. 安装/修复pip"
4. 选择 "1. 使用ensurepip模块安装/修复pip"
5. 等待修复完成

## 注意事项

- 安装Python时需要管理员权限
- 建议使用国内镜像源以提高下载速度
- 如遇到pip相关问题，可使用程序内置的pip修复功能
- 对于网络环境较差的情况，建议使用wheel文件离线安装依赖库

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 更新日志

### v1.3.0
- 新增基于wxPython的GUI版本，具有现代、用户友好的设计
- 新增Python环境管理功能（虚拟环境）
- 新增工具菜单，包含代码格式化和代码检查功能
- 新增文件完整性检查和自动修复功能
- 新增全面的文档，包含使用指南和常见问题
- 更新主菜单以包含所有新功能
- 改进卸载包功能，支持包选择
- 将搜索和安装功能集成到GUI的单个选项卡中
- 美化GUI界面，增强菜单系统和视觉元素
- 更新所有文件的版本号为1.3.0

### v1.2.0
- 新增自动更新功能，支持从GitHub仓库直接下载最新版本
- 改进版本号比较逻辑，能够自动检测是否为最新版本
- 支持多种版本号格式的识别和比较
- 优化了更新过程的用户体验，添加了详细的进度提示
- 增强了网络错误处理，提高了更新过程的稳定性

### v1.1.0
- 重新设计程序结构，将功能重点从Python版本管理转向pip管理
- 新增批量包管理功能，支持批量更新、卸载、导出和从文件安装
- 为所有耗时操作添加了进度条和加载动画
- 优化了pip修复功能，提供多种修复方法
- 增强了镜像源管理功能，支持更多内置镜像源
- 修复了f-string语法错误和pip命令参数错误

### v1.0.0
- 初始版本发布
- 支持Python版本选择和安装
- 支持依赖库管理
- 支持pip修复
- 支持镜像源管理

---

**祝您使用愉快！** 🎉